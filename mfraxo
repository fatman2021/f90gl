# This makefile has been tested on
#   computer: IBM RS6000
#         OS: AIX 4.2
#   compiler: xlf 4.1.0.6
#          C: IBM AIX XL C Compiler/6000
#     OpenGL: AIX native OpenGL 1.2.5, Glut 3.7.1, f90gl 1.2.0

#------------- User configuration parameters ---------------

# modify these for your system

# any relative paths should be relative to a subdirectory of the directory
# containing this makefile

# procedure name mangling approach used by your fortran compiler
#  LOWERCASE  - convert to lower case
#  UNDERSCORE - convert to lower case and append underscore
#  UPPERCASE  - convert to upper case
FNAME = LOWERCASE

# the include directory(ies) for OpenGL (GL is a subdirectory of it) and GLUT
OGLINC = -I$(OPENGLHOME)/include -I/usr/include

# the include directory for X11
X11INC = -I/usr/include/X11

# the library directory(ies) for OpenGL and GLUT
OGLLIBDIR = -L$(OPENGLHOME)/lib -L/usr/lib

# the OpenGL, GLU and GLUT libraries
OGLLIB = -lglut -lGLU -lGL

# the library directory for X11
X11LIBDIR = -L/usr/lib

# the X11 libraries
X11LIB = -lXmu -lXi -lXext -lX11

# extra characters to put into the library names, in case there is
# more than one OpenGL installed.  For example if LIBNAME is Mesa
# then the libraries will be libMesaf90GL.a etc.
LIBNAME =

# commands for making a library
MAKELIB = ar rcv
RANLIB = ranlib

# fortran 90 compiler and compiler flags
F90 = xlf90
F90FLAGS = -F:f90

# C compiler and compiler flags
CC = cc
CFLAGS = -O2 -DFNAME=$(FNAME)
 
# The suffix for module files generated by the compiler.  If none are
# generated, then use 'junk' or something (do not leave it blank).
MOD = mod

# The compiler flag to get at the module file for opengl_kinds in ../include/GL
USEMOD = -I../include/GL

#----------- end of user configuration parameters ------------

# The preprocessor
F90PPR = ../util/sppr

# The include file for f90ppr directives
F90PPR_INC = ../fppincs/fppraxo

# collect the macros to be passed to subservant makefiles

PASSMACROS = "FNAME=$(FNAME)" "OGLINC=$(OGLINC)" \
     "MAKELIB=$(MAKELIB)" "RANLIB=$(RANLIB)" "F90=$(F90)" \
     "F90FLAGS=$(F90FLAGS)" "CC=$(CC)" "CFLAGS=$(CFLAGS)" "MOD=$(MOD)" \
     "USEMOD=$(USEMOD)" "X11INC=$(X11INC)" \
     "F90PPR=$(F90PPR)" "F90PPR_INC=$(F90PPR_INC)" \
     "OGLLIBDIR=$(OGLLIBDIR)" "OGLLIB=$(OGLLIB)" \
     "X11LIBDIR=$(X11LIBDIR)" "X11LIB=$(X11LIB)"

install:
	cd util; make -f mfmost sppr $(PASSMACROS)
	cd util; make -f mfmost mkfppinc $(PASSMACROS)
	cd gl; make -f mfmost install $(PASSMACROS) "LIBNAME=$(LIBNAME)"
	cd glu; make -f mfmost install $(PASSMACROS) "LIBNAME=$(LIBNAME)"
	cd glut; make -f mfmost install $(PASSMACROS) "LIBNAME="

clean:
	cd gl; make -f mfmost clean
	cd glu; make -f mfmost clean
	cd glut; make -f mfmost clean
	cd examples; make -f mfraxm clean
	cd util; make -f mfmost clean

reallyclean:
	cd gl; make -f mfmost clean
	cd glu; make -f mfmost clean
	cd glut; make -f mfmost clean
	cd examples; make -f mfraxm clean
	cd util; make -f mfmost clean
	rm -rf lib/lib*
	rm -f include/GL/*.mod
