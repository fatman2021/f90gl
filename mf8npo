# This makefile has been tested on
#   computer: Pentium II
#         OS: Windows NT 4.0 (Service Pack 4)
#   compiler: PGI pgf90 3.0-2
#          C: Microsoft Visual C++ 6.0
#     OpenGL: Microsoft OpenGL, GLUT 3.7.1

#------------- User configuration parameters ---------------

# modify these for your system

# any relative paths should be relative to a subdirectory of the directory
# containing this makefile

# procedure name mangling approach used by your fortran compiler
#  LOWERCASE  - convert to lower case
#  UNDERSCORE - convert to lower case and append underscore
#  UPPERCASE  - convert to upper case
FNAME = UNDERSCORE

# the include directory(ies) for OpenGL (GL is a subdirectory of it) and GLUT
#OGLINC = -I$(OGLHOME)/include
OGLINC =

# the include directory for X11
#X11INC = -I/usr/X11/include
X11INC =

# extra characters to put into the library names, in case there is
# more than one OpenGL installed.  For example if LIBNAME is Mesa
# then the libraries will be libMesaf90GL.a etc.
LIBNAME =

# commands for making a library
MAKELIB = ar rcv
RANLIB = ranlib

# fortran 90 compiler and compiler flags
F90 = pgf90
F90FLAGS = -O -Munix

# C compiler and compiler flags
CC = cl
CFLAGS = -Zl -DWIN32 -DPGI32 -DFNAME=$(FNAME)
 
# The suffix for module files generated by the compiler.  If none are
# generated, then use 'junk' or something (do not leave it blank).
MOD = mod

# The compiler flag to get at the module file for opengl_kinds in ../include/GL
USEMOD = -I../include/GL

#----------- end of user configuration parameters ------------

# The preprocessor
F90PPR = ../util/sppr

# The include file for f90ppr directives
F90PPR_INC = ../fppincs/fpp8npo

# collect the macros to be passed to subservant makefiles

PASSMACROS = "FNAME=$(FNAME)" "OGLINC=$(OGLINC)" \
     "MAKELIB=$(MAKELIB)" "RANLIB=$(RANLIB)" "F90=$(F90)" \
     "F90FLAGS=$(F90FLAGS)" "CC=$(CC)" "CFLAGS=$(CFLAGS)" "MOD=$(MOD)" \
     "USEMOD=$(USEMOD)" "X11INC=$(X11INC)" \
     "F90PPR=$(F90PPR)" "F90PPR_INC=$(F90PPR_INC)"

installit:
	cd util; make -f mfmost sppr $(PASSMACROS)
	cd gl; make -f mf8npo install $(PASSMACROS) "LIBNAME=$(LIBNAME)"
	cd glu; make -f mf8npo install $(PASSMACROS) "LIBNAME=$(LIBNAME)"
	cd glut; make -f mf8npo install $(PASSMACROS) "LIBNAME="

clean:
	cd gl; make -f mf8npo clean
	cd glu; make -f mf8npo clean
	cd glut; make -f mf8npo clean
	cd examples; make -f mf8npo clean
	cd util; make -f mfmost clean

reallyclean:
	cd gl; make -f mf8npo clean
	cd glu; make -f mf8npo clean
	cd glut; make -f mf8npo clean
	cd examples; make -f mf8npo clean
	cd util; make -f mfmost clean
	rm -rf lib/lib*
	rm -f include/GL/*.mod
