# This makefile has been tested on
#   computer: Power Mac G4
#         OS: MacOS X 10.5.1
#   compiler: G95 (GCC 4.0.3 (g95 0.91!) Nov 16 2007)
#          C: gcc (GCC version 4.0.1 (Apple Inc. build 5465))
#     OpenGL: OpenGL 1.5.5, Glut 3.7.1, f90gl 1.2.13

#------------- User configuration parameters ---------------

# modify these for your system

# any relative paths should be relative to a subdirectory of the directory
# containing this makefile

# procedure name mangling approach used by your fortran compiler
#  LOWERCASE  - convert to lower case
#  UNDERSCORE - convert to lower case and append underscore
#  UPPERCASE  - convert to upper case
FNAME = UNDERSCORE

# the include directory(ies) for OpenGL (GL is a subdirectory of it) and GLUT
OGLINC =

# the include directory for X11
X11INC =

# the library directory(ies) for OpenGL and GLUT
OGLLIBDIR =

# the OpenGL, GLU and GLUT libraries
OGLLIB =

# the library directory for X11
X11LIBDIR =

# the X11 libraries
#X11LIB = -Wl,-framework -Wl,GLUT -Wl,-framework -Wl,OpenGL -Wl,-framework -Wl,Cocoa
X11LIB = -framework  GLUT  -framework  OpenGL  -framework  Cocoa

# extra characters to put into the library names, in case there is
# more than one OpenGL installed.  For example if LIBNAME is Mesa
# then the libraries will be libMesaf90GL.a etc.
LIBNAME =

# commands for making a library
MAKELIB = ar rcv
RANLIB = ranlib

# fortran 90 compiler and compiler flags
#F90 = f95
F90 = g95
F90FLAGS = 

# C compiler and compiler flags
CC = cc
CFLAGS = -DFNAME=$(FNAME) -DMACOSX -DGLUT_XLIB_IMPLEMENTATION=14 -I/System/Library/Frameworks/Glut.framework/Headers
 
# The suffix for module files generated by the compiler.  If none are
# generated, then use 'junk' or something (do not leave it blank).
MOD = mod

# The compiler flag to get at the module file for opengl_kinds in ../include/GL
USEMOD = -I../include/GL

#----------- end of user configuration parameters ------------

# The preprocessor
F90PPR = ../util/sppr

# The include file for f90ppr directives
F90PPR_INC = ../fppincs/fpppxuo

# collect the macros to be passed to subservant makefiles

PASSMACROS = "FNAME=$(FNAME)" "OGLINC=$(OGLINC)" \
     "MAKELIB=$(MAKELIB)" "RANLIB=$(RANLIB)" "F90=$(F90)" \
     "F90FLAGS=$(F90FLAGS)" "CC=$(CC)" "CFLAGS=$(CFLAGS)" "MOD=$(MOD)" \
     "USEMOD=$(USEMOD)" "X11INC=$(X11INC)" \
     "F90PPR=$(F90PPR)" "F90PPR_INC=$(F90PPR_INC)" \
     "OGLLIBDIR=$(OGLLIBDIR)" "OGLLIB=$(OGLLIB)" \
     "X11LIBDIR=$(X11LIBDIR)" "X11LIB=$(X11LIB)"

default:
	cd util; make -f mfmost sppr $(PASSMACROS)
	cd util; make -f mfmost mkfppinc $(PASSMACROS)
	cd gl; make -f mfmost install $(PASSMACROS) "LIBNAME=$(LIBNAME)"
	cd glu; make -f mfmost install $(PASSMACROS) "LIBNAME=$(LIBNAME)"
	cd glut; make -f mfmost install $(PASSMACROS) "LIBNAME="

clean:
	cd gl; make -f mfmost clean
	cd glu; make -f mfmost clean
	cd glut; make -f mfmost clean
	cd examples; make -f mf8lbm clean
	cd util; make -f mfmost clean

reallyclean:
	cd gl; make -f mfmost clean
	cd glu; make -f mfmost clean
	cd glut; make -f mfmost clean
	cd examples; make -f mf8lbm clean
	cd util; make -f mfmost clean
	rm -rf lib/lib*
	rm -f include/GL/*.mod
